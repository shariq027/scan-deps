package db

type Severity struct {
	Type  string `json:"type"`
	Score string `json:"score"`
}

type DatabaseSpecific struct {
	CWEIds          []string `json:"cwe_ids"`
	Github_Reviewed bool     `json:"github_reviewed"`
	Severity        string   `json:"severity"`
}

type Package struct {
	Name      string `json:"name"`
	Ecosystem string `json:"ecosystem"`
	Purl      string `json:"purl"`
}

type Event struct {
	Introduced string `json:"introduced"`
	Fixed      string `json:"fixed"`
}

type Range struct {
	Type   string  `json:"type"`
	Events []Event `json:"events"`
}

type DatabaseSpecificSource struct {
	Source string `json:"source"`
}

type Affected struct {
	Package          Package                `json:"package"`
	Ranges           []Range                `json:"ranges"`
	DatabaseSpecific DatabaseSpecificSource `json:"database_specific"`
}

type References struct {
	Type string `json:"type"`
	Url  string `json:"url"`
}

type Vuln []struct {
	Id               string           `json:"id"`
	Summary          string           `json:"summary"`
	Details          string           `json:"details"`
	Aliases          []string         `json:"aliases"`
	Modified         string           `json:"modified"`
	Published        string           `json:"published"`
	DatabaseSpecific DatabaseSpecific `json:"database_specific"`
	References       []References     `json:"references"`
	Affected         []Affected       `json:"affected"`
	SchemaVersion    string           `json:"schema_version"`
	Severity         []Severity       `json:"severity"`
}

type Vulnerability struct {
	Vulns   Vuln   `json:"vulns"`
	Name    string `json:"name"`
	Version string `json:"version"`
	Type    string `json:"type"`
}

type Result struct {
	PkgVuln Vulnerability
	Err     error
}

type Pkg struct {
	Name      string `json:"name"`
	Ecosystem string `json:"ecosystem"`
}

type OsvInput struct {
	Version string `json:"version"`
	Pkg     Pkg    `json:"package"`
}
